<script setup lang="ts">
import { computed } from 'vue'
import type { ReplyItem } from '@/models/communication/comment_model.ts'

const user_reply_items = defineModel<ReplyItem>()

const is_root = computed(() => {
  return !user_reply_items.value?.root
})
</script>

<template>
  <div class="comment-item">
    <el-avatar
      class="user-avater"
      alt="加载失败"
      :size="is_root ? 'large' : 'small'"
      :src="user_reply_items?.member.avatar ?? 'https://static.hdslb.com/images/member/noface.gif'"
    />
    <div class="comment-main">
      <el-card>
        <template #header>
          <div class="user-info">
            <div class="user-name">
              {{ user_reply_items?.member.uname }}
            </div>
            <div class="user-level">
              <img
                width="30"
                height="30"
                :src="`https://i0.hdslb.com/bfs/seed/jinkela/short/webui/user-profile/img/level_${user_reply_items?.member.level_info.current_level ?? 0}.svg`"
                alt="加载失败"
              />
            </div>
          </div>
        </template>
        <template #default>
          <div class="comment-content">
            <mavon-editor
              :value="user_reply_items?.content"
              :subfield="false"
              defaultOpen="preview"
              :toolbarsFlag="false"
              :editable="false"
              :scrollStyle="true"
              style="min-height: 20px"
            >
            </mavon-editor>
          </div>
        </template>
        <template #footer>
          <div class="comment-footer">
            <div class="pubdate">
              {{ user_reply_items?.ctime }}
            </div>
            <div class="like">
              <button class="like-btn">
                <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" size="16">
                  <path
                    d="M13.8962 3.29379C13.6991 3.27081 13.5193 3.35934 13.4323 3.46114C12.8422 4.15139 12.7053 5.18911 12.2617 5.97479C11.6495 7.05913 11.0738 7.72156 10.3661 8.342C9.84237 8.80118 9.29956 9.13799 8.75 9.32649L8.75 19.4799C9.46417 19.4939 10.2202 19.5025 11 19.5025C13.2417 19.5025 15.1433 19.4313 16.4244 19.3654C17.2614 19.3223 17.9677 18.9103 18.3318 18.2626C18.902 17.2482 19.6036 15.7628 20.0283 14.0162C20.4272 12.3757 20.6088 11.0287 20.6901 10.0811C20.7144 9.79882 20.496 9.50004 20.08 9.50004L15.0977 9.50004C14.7643 9.50004 14.4528 9.3339 14.2671 9.057C14.0815 8.78018 14.046 8.42905 14.1724 8.12067C14.4678 7.38274 14.7294 6.60729 14.8469 5.81993C14.9601 5.06136 14.9256 4.49492 14.6546 3.98104C14.356 3.41503 14.047 3.31137 13.8962 3.29379zM16.5034 7.50004L20.08 7.50004C21.5334 7.50004 22.8185 8.67208 22.6828 10.2523C22.5936 11.2911 22.397 12.7396 21.9717 14.4888C21.4915 16.4634 20.7052 18.1219 20.0752 19.2427C19.3296 20.569 17.9517 21.2894 16.5272 21.3627C15.2195 21.4301 13.2828 21.5025 11 21.5025C8.78846 21.5025 6.76783 21.4345 5.33637 21.3692C3.61107 21.2905 2.15601 20.0068 1.96937 18.2415C1.85494 17.1593 1.75 15.7578 1.75 14.2525C1.75 12.8731 1.83811 11.6227 1.94119 10.6309C2.1345 8.77093 3.72977 7.50004 5.50754 7.50004L7.75 7.50004C7.98778 7.50004 8.42634 7.38285 9.0476 6.83815C9.58957 6.36298 10.021 5.87557 10.5201 4.99152C11.0455 4.061 11.2013 2.99289 11.9121 2.16154C12.4209 1.56636 13.2518 1.2051 14.1278 1.30725C15.0502 1.4148 15.8767 2.01121 16.4236 3.04794C16.9801 4.10301 16.9665 5.16666 16.825 6.11504C16.7548 6.58534 16.6305 7.07392 16.5034 7.50004zM6.75 19.4248L6.75 9.50004L5.50754 9.50004C4.6608 9.50004 4.00848 10.0871 3.93048 10.8376C3.83294 11.7761 3.75 12.956 3.75 14.2525C3.75 15.6691 3.84901 16.9977 3.95828 18.0312C4.03598 18.7661 4.64129 19.3354 5.42751 19.3713C5.82532 19.3894 6.2691 19.4078 6.75 19.4248z"
                  />
                </svg>
                <span class="like-num">{{ user_reply_items?.like }}</span>
              </button>
            </div>
            <div class="dislike">
              <button class="dislike-btn">
                <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" size="16">
                  <path
                    d="M13.8962 20.7062C13.6991 20.7292 13.5193 20.6407 13.4323 20.5389C12.8422 19.8486 12.7053 18.8109 12.2617 18.0252C11.6495 16.9409 11.0738 16.2784 10.3661 15.658C9.84237 15.1988 9.29956 14.862 8.75 14.6735L8.75 4.52014C9.46417 4.50612 10.2202 4.49751 11 4.49751C13.2417 4.49751 15.1433 4.56866 16.4244 4.63463C17.2614 4.67773 17.9677 5.08968 18.3318 5.73738C18.902 6.75176 19.6036 8.23722 20.0283 9.98379C20.4272 11.6243 20.6088 12.9713 20.6901 13.9189C20.7144 14.2012 20.496 14.5 20.08 14.5L15.0977 14.5C14.7643 14.5 14.4528 14.6661 14.2671 14.943C14.0815 15.2198 14.046 15.5709 14.1724 15.8793C14.4678 16.6173 14.7294 17.3927 14.8469 18.1801C14.9601 18.9386 14.9256 19.5051 14.6546 20.019C14.356 20.585 14.047 20.6886 13.8962 20.7062zM16.5034 16.5L20.08 16.5C21.5334 16.5 22.8185 15.3279 22.6828 13.7477C22.5936 12.7089 22.397 11.2604 21.9717 9.51124C21.4915 7.53658 20.7052 5.8781 20.0752 4.75735C19.3296 3.43104 17.9517 2.71063 16.5272 2.63728C15.2195 2.56993 13.2828 2.49751 11 2.49751C8.78846 2.49751 6.76783 2.56549 5.33637 2.63078C3.61107 2.70948 2.15601 3.99324 1.96937 5.7585C1.85494 6.84073 1.75 8.24225 1.75 9.74751C1.75 11.1269 1.83811 12.3773 1.94119 13.3691C2.1345 15.2291 3.72977 16.5 5.50754 16.5L7.75 16.5C7.98778 16.5 8.42634 16.6172 9.0476 17.1618C9.58957 17.637 10.021 18.1244 10.5201 19.0085C11.0455 19.939 11.2013 21.0071 11.9121 21.8385C12.4209 22.4336 13.2518 22.7949 14.1278 22.6928C15.0502 22.5852 15.8767 21.9888 16.4236 20.9521C16.9801 19.897 16.9665 18.8333 16.825 17.885C16.7548 17.4147 16.6305 16.9261 16.5034 16.5zM6.75 4.57523L6.75 14.5L5.50754 14.5C4.6608 14.5 4.00848 13.9129 3.93048 13.1624C3.83294 12.2239 3.75 11.044 3.75 9.74751C3.75 8.33092 3.84901 7.00226 3.95828 5.96879C4.03598 5.23387 4.64129 4.66457 5.42751 4.62871C5.82532 4.61056 6.2691 4.59222 6.75 4.57523z"
                  />
                </svg>
                <span class="dislike-num">{{ user_reply_items?.dislike }}</span>
              </button>
            </div>
            <div class="reply">
              <button>回复</button>
            </div>
          </div>
        </template>
      </el-card>
      <div
        class="comment-tag"
        v-if="is_root && user_reply_items?.up_action.like"
        style="
          color: #757575;
          background-color: #f4f4f4;
          padding: 6px;
          border-radius: 2px;
          box-sizing: border-box;
          font-size: 12px;
          line-height: 1;
        "
      >
        UP主觉得很赞
      </div>
    </div>
  </div>
</template>

<style scoped></style>
